import{_ as G}from"./SiteLayout.vue_vue_type_script_setup_true_lang-DzVy2XUS.js";import{_ as j,a as R,b as W,c as Z,d as J}from"./ShareMenu.vue_vue_type_script_setup_true_lang-CZY68jfg.js";import{y as w,i as f,B as T,S as C,D as P,d as k,E as D,k as S,A as K,z as A,b,o as d,w as z,e as a,u as l,a as h,f as V,c as m,x as X,G as I,t as M,g as U,P as q,F as H,h as O,r as N,p as Q,n as F,H as Y,I as ee,m as te,J as se,K as oe}from"./app-CRVfHUbl.js";import"./AppLogoIcon.vue_vue_type_script_setup_true_lang-BpLbFC4_.js";import"./index-Dd5QN_LQ.js";import"./index-DfbCg4Oz.js";function ne(r){const t=w(()=>r.split(/<\/p>/).filter(Boolean).map((o,n)=>({html:o+"</p>",origIdx:n,hasMedia:/<(img|iframe)/.test(o)}))),e=w(()=>t.value.filter(o=>!o.hasMedia).map((o,n)=>({html:o.html,origIdx:o.origIdx,seqIdx:n}))),s=w(()=>{const o=[];return t.value.filter(n=>n.hasMedia).forEach(n=>{const i=e.value.find(g=>g.origIdx>n.origIdx),u=i?i.seqIdx:e.value.length-1,c=n.html.match(/src="([^"]+)"/);c&&o.push({index:u,src:c[1],type:n.html.includes("<img")?"image":"video"})}),o});return{blocks:t,textBlocks:e,mediaItems:s}}function ae(r){const t=f(!1),e=T([]),s=T([]),o=T([]),n=T("");return{isDesktop:t,blocks:e,textBlocks:s,mediaItems:o,rawBody:n,updateLayout:()=>{if(t.value=window.innerWidth>=1280,t.value){const u=ne(r);e.value=u.blocks.value,s.value=u.textBlocks.value,o.value=u.mediaItems.value,n.value=""}else n.value=r,e.value=[],s.value=[],o.value=[]}}}P.registerPlugin(C);function re(){const r=f(null);function t(s){window.innerWidth<1280||(C.getAll().forEach(o=>o.kill()),s.forEach((o,n)=>{const i=document.querySelector(`[data-paragraph="${o.index}"]`),u=s[n+1],c=u?document.querySelector(`[data-paragraph="${u.index}"]`):document.body;i instanceof HTMLElement&&C.create({trigger:i,start:"top center",endTrigger:c||void 0,end:"top center",scrub:!0,onEnter:()=>r.value=o.index,onEnterBack:()=>r.value=o.index,onLeave:()=>{n<s.length-1&&(r.value=null)},onLeaveBack:()=>{n>0&&(r.value=null)}})}))}function e(){C.getAll().forEach(s=>s.kill())}return{activeIdx:r,initTriggers:t,destroyTriggers:e}}function le(){const r=f("collapsed"),t=w(()=>r.value==="collapsed");return{layoutState:r,isCollapsed:t,toggle:()=>{r.value=r.value==="collapsed"?"expanded":"collapsed"}}}const ie=["data-state"],ue={class:"media-sticky"},de={class:"mobile-interactions-wrapper"},ce=k({__name:"BlogPostRoot",props:{post:{},comments:{},meta:{},mentionableUsers:{},url:{}},setup(r){const t=r,e=f({...t.post}),{activeIdx:s,initTriggers:o,destroyTriggers:n}=re(),{isDesktop:i,textBlocks:u,mediaItems:c,rawBody:g,updateLayout:v}=ae(t.post.body),{layoutState:_,toggle:p}=le();D("layoutState",{state:_,toggle:p}),D("postData",t.post),D("textBlocks",u),S(()=>{v(),window.addEventListener("resize",v),K(()=>{setTimeout(()=>{i.value&&o(c.value)},100)})}),A(()=>{n(),window.removeEventListener("resize",v)});function L(y){s.value=y}const $=f(window.innerWidth<1280);function x(){$.value=window.innerWidth<1280}return S(()=>window.addEventListener("resize",x)),A(()=>window.removeEventListener("resize",x)),(y,B)=>(d(),b(G,null,{default:z(()=>[a("main",{class:"blog-post | container","data-type":"extra-wide","data-state":l(_)},[h(l(Be),{url:t.url},null,8,["url"]),h(l(qe),{comments:t.comments,mentionableUsers:t.mentionableUsers,meta:t.meta,"text-blocks":l(u),"raw-body":l(g),"is-desktop":l(i),onParagraphVisible:L},null,8,["comments","mentionableUsers","meta","text-blocks","raw-body","is-desktop"]),a("div",ue,[l(i)?(d(),b(l(Re),{key:0,items:l(c),"active-index":l(s)},null,8,["items","active-index"])):V("",!0)])],8,ie),a("section",de,[h(j,{variant:"mobile",post:e.value,"onUpdate:post":B[0]||(B[0]=E=>e.value=E)},null,8,["post"]),h(R,{class:"share-menu share-menu--mobile",url:t.url,variant:"mobile"},null,8,["url"]),$.value?(d(),b(W,{key:0,reportable:{id:y.post.id,type:"post"},popoverId:`reportPopover-mobile-${y.post.id}`},null,8,["reportable","popoverId"])):V("",!0)])]),_:1}))}}),pe=["aria-pressed"],me=["width","height"],he=["fill"],ge=k({__name:"ToggleIcon",props:{color:{default:"#2587A4"},hoverColor:{default:"#35A6C2"},viewBox:{},size:{default:"24px"}},setup(r){const t=f(!1);return(e,s)=>(d(),m("button",{class:"toggle-icon",onMouseenter:s[0]||(s[0]=o=>t.value=!0),onMouseleave:s[1]||(s[1]=o=>t.value=!1),"aria-pressed":t.value},[(d(),m("svg",{xmlns:"http://www.w3.org/2000/svg",width:e.size,height:e.size,viewBox:"0 0 21.5 21.5"},[a("path",{fill:t.value?e.hoverColor:e.color,id:"Vector",d:"M7,20h6c5,0,7-2,7-7V7c0-5-2-7-7-7H7C2,0,0,2,0,7v6C0,18,2,20,7,20Z",transform:"translate(0.75 0.75)",stroke:"#292d32","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"0"},null,8,he),s[2]||(s[2]=X('<g id="Group" transform="translate(-301.25 -381.25)"><path id="Vector-2" data-name="Vector" d="M3.04,0,0,3.04" transform="translate(314.11 393.82)" fill="none" stroke="#E5F3F9" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path><path id="Vector-3" data-name="Vector" d="M0,0H10.3" transform="translate(306.85 393.82)" fill="none" stroke="#E5F3F9" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path></g><g id="Group-2" data-name="Group" transform="translate(-301.25 -381.25)"><path id="Vector-4" data-name="Vector" d="M0,3.04,3.04,0" transform="translate(306.85 387.14)" fill="none" stroke="#E5F3F9" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path><path id="Vector-5" data-name="Vector" d="M10.3,0H0" transform="translate(306.85 390.18)" fill="none" stroke="#E5F3F9" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path></g>',2))],8,me))],40,pe))}}),ve={class:"blog-post__header","grid-area":"header"},_e={class:"post-header-sticky-wrapper"},fe={class:"post-header container","data-type":"blog-post"},ke={class:"post-header__meta-group"},we={class:"post-title"},ye={class:"meta-primary"},be={class:"no-decor"},$e={class:"date"},xe={class:"desktop-interactions-wrapper"},Be=k({__name:"BlogPostHeader",props:{url:{}},setup(r){const t=r,e=I("postData"),s=I("layoutState"),o=f({...e}),n=f(window.innerWidth<1280);function i(){n.value=window.innerWidth<1280}return S(()=>window.addEventListener("resize",i)),A(()=>window.removeEventListener("resize",i)),(u,c)=>{var g,v,_;return d(),m("section",ve,[a("div",_e,[a("header",fe,[h(ge,{size:"34",class:"toggle-media-button",onClick:c[0]||(c[0]=p=>l(s).toggle())}),a("article",ke,[a("h1",we,M((g=l(e))==null?void 0:g.title),1),a("div",ye,[a("div",be,[c[2]||(c[2]=U(" by ")),h(l(q),{class:"author",href:l(e).user?u.route("author.posts",{user:l(e).user}):"/"},{default:z(()=>{var p;return[U(M(((p=l(e).user)==null?void 0:p.username)||"Rattlehead"),1)]}),_:1},8,["href"])]),a("p",$e,M((v=l(e))==null?void 0:v.smart_date),1),h(l(q),{class:"category",href:u.route("category.index",{slug:(_=l(e).category)==null?void 0:_.slug})},{default:z(()=>{var p;return[U(M((p=l(e).category)==null?void 0:p.name),1)]}),_:1},8,["href"])])])]),a("section",xe,[h(j,{post:o.value,class:"stick-this","onUpdate:post":c[1]||(c[1]=p=>o.value=p)},null,8,["post"]),h(R,{url:t.url,class:"share-menu share-menu--desktop",variant:"desktop"},null,8,["url"]),n.value?V("",!0):(d(),b(W,{key:0,reportable:{id:l(e).id,type:"post"},popoverId:`reportPopover-desktop-${l(e).id}`},null,8,["reportable","popoverId"]))])])])}}}),Me=["srcset"],Ie=["srcset"],Le=["src","srcset","alt"],Ee=["src","alt"],Te=k({__name:"Lightbox",props:{post:{}},setup(r){const t=f(!1);return(e,s)=>{var o,n,i,u,c,g,v,_,p,L,$,x,y,B;return d(),m(H,null,[a("picture",{class:"preview-img-wrapper",onClick:s[0]||(s[0]=E=>t.value=!0)},[a("source",{media:"(min-width: 1280px)",srcset:(n=(o=e.post)==null?void 0:o.thumbnail_urls)==null?void 0:n.max},null,8,Me),a("source",{media:"(min-width: 768px)",srcset:(u=(i=e.post)==null?void 0:i.thumbnail_urls)==null?void 0:u.lg},null,8,Ie),a("img",{src:(g=(c=e.post)==null?void 0:c.thumbnail_urls)==null?void 0:g.sm,srcset:`${(_=(v=e.post)==null?void 0:v.thumbnail_urls)==null?void 0:_.md} 768w, ${(L=(p=e.post)==null?void 0:p.thumbnail_urls)==null?void 0:L.lg} 1280w`,sizes:"(max-width: 767px) 100vw, (max-width: 1279px) 80vw, 1200px",alt:($=e.post)==null?void 0:$.title,class:"preview-img"},null,8,Le)]),t.value?(d(),m("div",{key:0,class:"lightbox",onClick:s[2]||(s[2]=O(E=>t.value=!1,["self"]))},[a("button",{class:"close-btn",onClick:s[1]||(s[1]=E=>t.value=!1)},s[3]||(s[3]=[a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-6"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})],-1)])),a("img",{src:(y=(x=e.post)==null?void 0:x.thumbnail_urls)==null?void 0:y.max,alt:(B=e.post)==null?void 0:B.title,class:"lightbox-image"},null,8,Ee)])):V("",!0)],64)}}}),Ce=["innerHTML"],Pe=["innerHTML","data-index","data-paragraph"],Se=k({__name:"ParagraphBlock",props:{html:{type:String,required:!0},index:{type:Number,required:!0},isDesktop:{type:Boolean,required:!1,default:!1}},setup(r){const t=r,e=f(null);return w(()=>{}),(s,o)=>r.isDesktop?(d(),m("div",{key:1,innerHTML:r.html,"data-index":t.index,"data-paragraph":r.index},null,8,Pe)):(d(),m("div",{key:0,ref_key:"el",ref:e,innerHTML:r.html,class:"paragraph-block"},null,8,Ce))}}),ze={class:"blog-post__body | container","data-type":"blog-post","data-align":"start","grid-area":"content"},Ve={class:"blog-post__body__subheader | flow"},He=["innerHTML"],De={key:0},Ue=["innerHTML"],Ae={class:"blog-post__comments"},qe=k({__name:"BlogPostContent",props:{comments:{},mentionableUsers:{},meta:{},textBlocks:{},rawBody:{},isDesktop:{type:Boolean}},setup(r){const t=r,e=I("postData"),s=w(()=>Array.isArray(t.mentionableUsers)?t.mentionableUsers:[]);return(o,n)=>{var i;return d(),m("section",ze,[a("article",Ve,[h(Te,{post:l(e)},null,8,["post"]),a("p",{class:"extract",innerHTML:(i=l(e))==null?void 0:i.extract},null,8,He)]),o.isDesktop?(d(),m("div",De,[(d(!0),m(H,null,N(t.textBlocks,u=>(d(),b(Se,{key:u.seqIdx,html:u.html,index:u.seqIdx,"is-desktop":o.isDesktop},null,8,["html","index","is-desktop"]))),128))])):(d(),m("div",{key:1,innerHTML:t.rawBody},null,8,Ue)),n[0]||(n[0]=a("hr",{class:"straight-large"},null,-1)),a("article",Ae,[h(Z,{post:l(e)},null,8,["post"]),h(J,{post:l(e),comments:o.comments,users:s.value,depth:0},null,8,["post","comments","users"])])])}}});function Fe(r,t){const e=f([]);function s(o){return n=>{n instanceof HTMLElement?e.value[o]=n:e.value[o]=null}}return S(()=>{P.set(e.value,{autoAlpha:0,y:50})}),Q(t,o=>{if(P.to(e.value,{autoAlpha:0,y:50,duration:.3}),o!==null){const n=e.value[r.findIndex(i=>i.index===o)];n&&P.to(n,{autoAlpha:1,y:0,duration:.6,ease:"power3.out"})}}),{mediaEls:e,setMediaEl:s}}const je={class:"media-container"},Re=k({__name:"BlogPostMedia",props:{items:{},activeIndex:{}},setup(r){const t=I("layoutState");I("postData");const e=r;return w(()=>e.items.find(s=>s.index===e.activeIndex)??null),Fe(e.items,()=>e.activeIndex),(s,o)=>(d(),m("section",{class:F(["blog-post__media",{collapsed:l(t).state.value==="collapsed"}]),"grid-area":"media"},[a("div",je,[(d(!0),m(H,null,N(s.items,(n,i)=>(d(),m("div",{key:n.src,class:F(["media-item",{visible:n.index===s.activeIndex}])},[(d(),b(Y(n.type==="image"?"img":"iframe"),{src:n.src,class:"media-element"},null,8,["src"]))],2))),128))])],2))}}),We=ee();w(()=>{try{return We.props.mentionableUsers||[]}catch{return[]}});const Ne=["content"],Ge=["content"],Ze=["content"],Je=["content"],Ke=["content"],Xe=["content"],Oe=["content"],Qe=["content"],Ye=["content"],et=k({__name:"BlogPostMeta",props:{meta:{}},setup(r){return(t,e)=>(d(),b(l(te),null,{default:z(()=>{var s,o,n,i,u,c,g,v,_,p;return[a("title",null,M((s=t.meta)==null?void 0:s.title),1),a("meta",{name:"description",content:(o=t.meta)==null?void 0:o.extract},null,8,Ne),a("meta",{name:"author",content:(n=t.meta)==null?void 0:n.author},null,8,Ge),a("meta",{property:"og:title",content:(i=t.meta)==null?void 0:i.title},null,8,Ze),a("meta",{property:"og:description",content:(u=t.meta)==null?void 0:u.extract},null,8,Je),a("meta",{property:"og:image",content:(c=t.meta)==null?void 0:c.thumbnail},null,8,Ke),a("meta",{property:"og:url",content:(g=t.meta)==null?void 0:g.url},null,8,Xe),e[0]||(e[0]=a("meta",{property:"og:type",content:"article"},null,-1)),e[1]||(e[1]=a("meta",{property:"og:locale",content:"es_MX"},null,-1)),e[2]||(e[2]=a("meta",{name:"twitter:card",content:"summary_large_image"},null,-1)),a("meta",{name:"twitter:title",content:(v=t.meta)==null?void 0:v.title},null,8,Oe),a("meta",{name:"twitter:description",content:(_=t.meta)==null?void 0:_.extract},null,8,Qe),a("meta",{name:"twitter:image",content:(p=t.meta)==null?void 0:p.thumbnail},null,8,Ye)]}),_:1}))}}),lt=k({__name:"show",props:{post:{},comments:{},meta:{},mentionableUsers:{},url:{}},setup(r){const t=r;return(e,s)=>(d(),m(H,null,[h(et,{meta:t.meta},null,8,["meta"]),h(l(ce),se(oe(e.$props)),null,16)],64))}});export{lt as default};
